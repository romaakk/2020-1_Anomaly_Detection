# 2020-1_Anomaly_Detection
Anomaly Detection in IIoT Control Systems using AI

*목적 및 배경

이상 탐지 분야에서 해결해야 할 큰 문제 중 하나는 False Alarm의 최소화이다. 
잦은 False Alarm은 현장의 생산성에 약영향을 주기 때문에, 디지털화된 산업현장에서 큰 영향을 끼친다.
이에, IIoT 제어시스템을 위한 AI 기반의 침입 감지 시스템을 학습시키는 과정에서 측정 값들의 국지적인 등락 패턴을 통해 False Alarm을 감소시키는 방법을 제안한다.
False Alarm을 발생시킬 수 있는 다양한 요소들 중, 센서 이상에 따른 계측 오차를 대상으로 진행하였다.


*데이터셋

국가보안기술연구소가 공개한 AI 학습용 산업제어시스템 보안 데이터셋인 'HAI 1.0'을 이용했다.
테스트베드에서 정상 상태와 공격을 재현한 데이터셋으로, 각 센서의 측정값과 공격의 여부로 이루어진 시계열 데이터이다.


*테스트데이터

센서 오류에 대한 모델의 분류 성능확인을 위해, HAI 1.0과 Description을 기반으로 계측오차값을 포함한 테스트 데이터를 생성한다.
테스트 데이터는 공격과 직접 관련된 2개의 포인트 P1.B3004, P1.B3005(이하 A1, A2)와 공격과 무관한 포인트 P1.B4002(이하, N)에 대해 값을 조작한다.
임의의 시간대를 선택하여 3개의 포인트의 값을 정상 범위 이상의 값으로 조정한다. 데이터를 여러 섹터로 나누고, 원래의 값과 섹터의 평균값 등을 이용해 정상 범위를 벗어나도록한다.
선택된 포인트의 수, 삽입된 오류 데이터의 비율에 따라 다양한 테스트 데이터를 생성한다.


*등락 패턴의 계산

각 시간대를 기준으로 이전의 4개의 시간대에서 각 포인트의 등락을 계산한다.
연속된 5개 단위시간 동안의 포인트의 평균값과 표준편차를 계산하여, 현재의 값을 UP/MID/DOWN으로 구별한다.
5개의 시간대를 이용하므로 등락패턴은 243개가 되나, 보편적인 패턴을 확보하기 위해 5개의 시간대를 3개의 시간대로 압축한다.
5개의 시간대를 Sliding Window 방식으로 3개씩 평균을 내어 현재의 값을 대체한다.


*학습 모델

기계학습 모델로는 Gradient Boosting 기반의 XGBoost 라이브러리를 이용했다.


*학습 및 테스트

1. 대조군
계측오차를 삽입하지 않은 학습데이터를 이용. 기본적인 Scaling 및 PCA 적용
XGBoost 분류 모델을 학습시키고, 계측오차를 삽입한 데이터에 대한 성능을 확인
분류 정확도와 공격으로 잘못 분류된 계측오차의 비율을 기록

2. 실험군
계측오차를 삽입하지 않은 학습데이터에 각 포인트에서의 등락 패턴을 더하여 학습에 이용. 기본적인 Scaling과 PCA 적용
XGBoost 분류 모델을 학습시키고, 계측오차를 삽입한 데이터에 대하여 등락패턴을 더하여 성능 확인
분류 정확도와 공격으로 잘못 분류된 계측오차의 비율을 기록


*결과

실험군이 비슷하거나 약간 더 높은 정확도를 유지한다.
A1 / A1,N / A2,N / A1,A2 / A1,A2,N 포인트에 계측오차를 삽입한 경우, 잘못 분류된 계측오차의 비율이 적게는 10%에서 크게는 47%만큼 감소하였다.
대부분의 테스트에서 공격으로 잘못 분류된 계측오차의 비율이 감소하였다.

반면, N / A2 포인트에 계측오차를 삽입한 경우,
대조군보다 1~2% 가량 낮은 정확도와 1~4% 가량의 오분류 비율이 증가하는 것을 확인하였다.
포인트의 특성에 따라 어느정도 차이가 있는 것으로 판단됨.


*결론

AI를 이용한 IIoT 제어시스템의 Anomaly Detection에서는 주변 시간대에서의 특정 포인트의 국지적인 등락 패턴을 이용하여, 랜덤하게 발생하는 측정 오류 값에 의한 False Alarm의 비율을 낮출 수 있었다.



